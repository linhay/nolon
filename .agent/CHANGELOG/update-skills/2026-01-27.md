# Skills & Workflows 迭代复盘 - 2026-01-27

## 0. 对话概览
本次对话的核心任务是对 `nolon` 项目的卡片组件（SkillCard, McpServerCard, WorkflowCard）进行 UI 重构与功能对齐。重点在于统一视觉风格（间距、布局、按钮样式）、增加操作安全性（二次确认弹窗）以及修复 MCP 工作流的同步机制。

## 1. 本次使用的 Skills / Workflows
- `/ui-ux-pro-max`: 用于指导 SwiftUI 界面开发与命名规范。
- `/verify-build`: 用于验证编译情况。

## 2. 负反馈记录
- **编译依赖遗漏**: 在修改 `SkillCardView` 的构造函数以增加 `onUnlinkWorkflow` 回调时，未能同步更新现有的调用点（如 `ProviderSkillsGridView`），导致编译中断。
- **访问控制不一致**: 在 `SkillInstaller`（public 类）中新增处理 `MCP` 的方法时，未发现 `MCP` 结构体为 `internal`，导致编译报错。
- **功能一致性缺失**: 最初实现的 MCP 工作流关联仅在全局目录生成文件，忽略了 Provider 目录的同步（Symlink），导致 IDE 无法识别工作流，与 Skill 工作流的行为不一致。
- **SwiftUI 顺序敏感**: 在初始化 `McpServerCard` 时，闭包参数顺序与定义不匹配。

## 3. 习惯/风格学习（偏好沉淀）
- **UI 设计偏好**: 
    - 统一使用 16pt 的主要内边距和 12pt 的内部元素间距。
    - 卡片标题与更多菜单必须同行显示（HStack）。
    - 重型操作（删除/卸载）必须收纳进菜单中，并具备二次确认。
- **代码交互偏好**:
    - 在修改公共库/底层服务方法签名时，必须先行全局搜索受影响的调用点。
    - 保持基础设施层（Infrastructure）的架构一致性。
- **本地化自动化**: 
    - 发现项目配套有 `scripts/extract_missing_translations.py` 和 `import_translations.py`。
    - **习惯**: 在所有 UI 修改完成后，必须运行提取脚本检查缺失翻译，并统一执行导入。严禁手动修改 `Localizable.xcstrings` 以免格式损坏。
- **发布说明同步**:
    - 在完成核心逻辑（如 Symlink 同步）修改后，应立即同步更新 `docs/` 下对应的版本发布说明。

## 4. 现有 Skills / Workflows 迭代建议
### `/ui-ux-pro-max`
- 已增加：布局一致性 (16pt/12pt)、交互安全性 (confirmationDialog)、组件契约 (调用点同步更新)。

## 5. 新增 Skill / Workflow 建议
### 新增 Skill: `localization-workflow.md`
- **目的**: 规范项目内多语言翻译的自动化流程。
- **核心步骤**: 运行提取脚本 -> 在 `translated_items.json` 中翻译 -> 运行导入脚本。

### 新增 Skill: `swift-coding-standards.md`
- 已创建：涵盖访问控制对齐与参数顺序一致性。
